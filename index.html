<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>点数增量重制版</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="icon.png">

  <script src="scripts/technical/vue.js" defer></script>
  <script src="scripts/technical/ExpantaNum.js" defer></script>
  <script src="scripts/technical/format-expantanum.js" defer></script>
  <script src="scripts/technical/pako.js" defer></script>
  <script src="scripts/technical/hotkeys.js" defer></script>
  <script src="scripts/display.js" defer></script>
  <script src="scripts/temp.js" defer></script>
  <script src="scripts/script.js" defer></script>
  <script src="scripts/sqrt.js" defer></script>
  <script src="scripts/square.js" defer></script>
  <script src="scripts/others.js" defer></script>
  <script src="scripts/newsticker.js" defer></script>
  <script src="scripts/save.js" defer></script>
  <script src="scripts/hotkey.js" defer></script>
  <script src="scripts/challenges.js" defer></script>
  <script src="scripts/components.js" defer></script>
</head>

<body>
  <div align="center">
    <div id="news">
      <p id="newsText" class="newsContent"></p>
    </div>
    <div id="notify" class="hide"></div>
  </div>
  <div id="app" align="center">
    <div id="loader-overlay" v-if="!hasLoaded.status">
      <div class="loader-text" align="center">游戏加载中......<br><span style='font-size: 18px'>这可能需要一些时间</span><br><noscript>本游戏无法运行于无javacript的环境下！</noscript></div>
    </div>
    <div v-if="hasLoaded.status">
      <div class="popup" v-if="app.isShowingPopup == 1">请输入存档<br><input v-model="save" placeholder="在此处键入存档"><br><button @click="importFromApp()" class="btn">导入</button></div>
      <div v-html="getPointDisplay()"></div>
      <div>{{ getPointGain() }}</div>
      <div style="color: yellow" v-if="player.square.unl">你有{{ player.square.points.format(0) }}点数<sup>2</sup>，因此√点数复制速度×{{ tmp.square.effect.format() }}</div>
      <div>
        <button @click="switchpage(1)" class="btn" :disabled="[1,4].includes(player.currentPage)">主要</button>
        <button @click="switchpage(5)" class="btn" :disabled="[5].includes(player.currentPage)" v-if="player.square.unl || player.sqrt.galaxies.gte(3)">重置</button>
        <button @click="switchpage(7)" class="square" :disabled="[7].includes(player.currentPage)" v-if="player.square.unl">平方</button>
        <button @click="switchpage(6)" class="btn" :disabled="[6].includes(player.currentPage)">统计</button>
        <button @click="switchpage(2)" class="btn" :disabled="[2,3].includes(player.currentPage)">选项</button>
      </div><br>
      <div>
        <button @click="switchpage(1)" class="btn" v-if="[1,4].includes(player.currentPage)" :disabled="player.currentPage == 1">维度</button>
        <button @click="switchpage(4)" class="btn" v-if="[1,4].includes(player.currentPage)" :disabled="player.currentPage == 4">√点数</button>
        <button @click="switchpage(2)" class="btn" v-if="[2,3].includes(player.currentPage)" :disabled="player.currentPage == 2">选项</button>
        <button @click="switchpage(3)" class="btn" v-if="[2,3].includes(player.currentPage)" :disabled="player.currentPage == 3">关于</button>
        <button @click="switchpage(7)" class="square" v-if="[7,8].includes(player.currentPage)" :disabled="player.currentPage == 7">升级</button>
        <button @click="switchpage(8)" class="square" v-if="[7,8].includes(player.currentPage) && hasSqUpg(4)" :disabled="player.currentPage == 8">挑战</button>
      </div><br>
      <div v-if="player.currentPage == 1">
        <button @click="buyall()" class="btn">购买最大</button>
        <template>
          <div v-for="dim in dimensions" :key="dim.id">
            <span v-if="player.dims[dim.id][1].gte(Number.MAX_VALUE)" style="color:red" display="inline-block">超级折算</span><span>{{ dim.label }}</span>
            <span>{{ formatWhole(player.dims[dim.id][5]) }}</span>
            <span>×{{ format(player.dims[dim.id][2]) }}</span>
            <button class="btn" @click="buydim(dim.id)" v-if="player.sqrt.galaxies.lt(1)">{{ getDimCostDisplay(dim.id) }}</button>
            <button class="btn" @click="buyMaxDim(dim.id)">{{ getMaxBtnText(dim.id) }}</button>
            <button class="btn" @click="changeAuto(dim.id)" v-if="player.canautodim">自动：{{ player.autodims[dim.id-1]? "开" : "关" }}</button>
          </div>
        </template>
      </div>
      <div v-if="player.currentPage == 2">
        <button class="btn" @click="formatted_hard_reset()">硬重置</button>
        <button class="btn" @click="export_copy()">导出</button>
        <button class="btn" @click="export_file()">导出为文件</button>
        <button class="btn" @click="import_save()">导入</button>
        <button class="btn" @click="import_file()">以文件导入</button>
      </div>
      <div v-if="player.currentPage == 3">
        <span v-html="formatEndgame()"></span><br>
        <span style="color: red">{{ getHotkeyText() }}</span><br>
        当前版本：v0.2.3<br>
        游戏作者：<sup>0100000a7</sup><br>
        本游戏使用了<a href="https://github.com/Naruyoko/ExpantaNum.js" target="_blank">ExpantaNum.js</a>
        <a href="https://github.com/cloudytheconqueror/letter-notation-format" target="_blank">format-expantanum.js</a>来处理大数字<br>
        使用了<a href="https://github.com/nodeca/pako" target="_blank">pako.js</a>来处理存档<br>
        <h1>-----更新日志-----</h1>
        <div>
          <h3>v0.2.3</h3><br>
          - 添加一个<spoiler>平方</spoiler>挑战<br>
        </div>
        <div>
          <h3>v0.2.2</h3><br>
          - 修复查看<spoiler>平方</spoiler>升级内容时升级会偏移的bug<br>
        </div>
        <div>
          <h3>v0.2.1</h3><br>
          - 修复电脑无法查看<spoiler>平方</spoiler>升级内容的bug<br>
        </div>
        <div>
          <h3>v0.2</h3><br>
          - 添加<spoiler>平方</spoiler>重置<br>
          - 添加4个升级<br>
        </div>
        <div>
          <h3>v0.1.6</h3><br>
          - 使用vue.js重构游戏界面<br>
        </div>
        <div>
          <h3>v0.1.5.1</h3><br>
          - 修复部分三叠纪时期的手机无法导出至剪贴板的bug<br>
          - 修改部分样式<br>
        </div>
        <div>
          <h3>v0.1.5</h3><br>
          - 添加<spoiler>快捷键</spoiler><br>
        </div>
        <div>
          <h3>v0.1.4.1</h3><br>
          - 修复<spoiler>星系</spoiler>不重置维度的bug<br>
        </div>
        <div>
          <h3>v0.1.4</h3><br>
          - 修改<spoiler>星系</spoiler>增益公式<br>
        </div>
        <div>
          <h3>v0.1.3.1</h3><br>
          - 完善<spoiler>自动化</spoiler>逻辑<br>
        </div>
        <div>
          <h3>v0.1.3</h3><br>
          - 添加<spoiler>星系</spoiler>重置<br>
          - Endgame增长至1.000e785<spoiler>点数</spoiler><br>
        </div>
        <div>
          <h4>v0.1.2 游戏体验似乎好点了?</h4>
            - 添加<spoiler>维度</spoiler>的最大购买按钮<br>
            - 添加<spoiler>√点数</spoiler>软上限(只不过在软上限开始的地方还有一个硬上限)<br>
            - 修改<spoiler>星系</spoiler>重置按钮<br>
            - 添加游戏加载提示<br>
            - 修复了chromium浏览器在切换页面5分钟后会导致游戏主循环计算变得及其缓慢的bug<br>
            - 修复了计时器掌控者等恶意脚本可以干扰游戏运行的bug<br>
        </div>
        <div>
          <h3>v0.1 开平方</h3><br>
            - 添加<spoiler>√点数</spoiler><br>
            - 画大饼(<spoiler>星系</spoiler>)<br>
        </div>
        <div>
          <h3>v0.0 维度</h3><br>
            - 添加<spoiler>维度1~8</spoiler><br>
        </div>
      </div>
      <div v-if="player.currentPage == 4">
        <div class="sqrt_text">你有{{ player.sqrt.points.format() }}√点数<span v-if="player.sqrt.unl">(+{{ format(tmp.sqrt.replicatePerTick.log10().mul(30)) }}数量级/s)</span>，因此所有维度乘数×{{ format(tmp.sqrt.dim_eff) }}</div>
        <div class="sqrt_text" v-if="!player.sqrt.unl">达到1.000e80点数后，你的√点数将开始自我复制!</div><br>
        <div class="sqrt_text">√星系({{ formatWhole(player.sqrt.galaxies) }})</div>
        <button class="galaxyReset" @click="galaxy()">获得一个星系<br>但重置之前的一切<br><span v-html="getGalRewardText()"></span><br>要求：{{ format(tmp.sqrt.galCost) }} √点数</button>
        <div>同时，你的√点数和星系还使购买10个的倍率+{{ tmp.sqrt.galaxyEffect.format(3) }}</div>
        <div style="color: red" v-if="tmp.sqrt.isSofted">在1.000e100√点数后，√点数复制速度将受到{{ tmp.sqrt.isCapped ? '硬' : '软' }}上限限制!</div>
        <div style="color: rgb(121, 0, 0)" v-if="player.sqrt.points.gte('1e400')">在1.000e400√点数后，√点数复制速度将受到二重软上限限制!</div>
      </div>
      <div v-if="player.currentPage == 5">
        <button class="square" @click="square()">重置之前的所有内容，但获取{{ tmp.square.gain.format() }}</span>点数<sup>2</sup><br>要求：1.000e785点数</button>
      </div>
      <div v-if="player.currentPage == 6">
        你总共制造了{{ formatWhole(player.total) }}点数<br>
        {{ get_pts_volume(player.points) }}<br><br>
        <div v-if="player.square.unl"><h2>点数<sup>2</sup></h2>
        你总共拥有{{ player.square.total }}点数<sup>2</sup></div>
      </div>
      <div v-if="player.currentPage == 7">
        <div class="upg_text_box"><span v-html="get_sq_upg_text()"></span></div><br>
        <template>
          <div>
            <table>
              <tr v-for="row in sq_upgs" key="row.id">
                <td v-for="upg in sq_upgs[row.id]" key="upg.id">
                  <div :class="'sq_upg' + (hasSqUpg(upg.id)? '_bought' : '') + (player.square.points.gte(app.squpgs2[upg.id-1].cost) && !hasSqUpg(upg.id)? '_buyable' : '')" @mouseover="hover_upg = upg.id" @mouseleave="hover_upg = 0" @click="buySqUpg(upg.id)"><span>{{ upg.id }}</span></div>
                </td>
              </tr>
            </table>
          </div>
        </template>
      </div>
      <div v-if="player.currentPage == 8">
        <template>
          <button :class="player.chal == chal.id? 'inchal' : (player.square.chals.includes(chal.id)? 'chalcomp' : 'chal')" v-for="chal in sq_chal" :key="chal.id" @click="handleChalButtonClick(chal.id)">
            C{{ chal.id }}
          </button>
        </template><br><br>
        <span v-html="get_sq_chal_text()"></span>
      </div>
    </div>
  </div>
</body>
</html>