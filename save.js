function generateRandomString(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let t="";const r=e.length;for(let a=0;a<100;a++)t+=e.charAt(Math.floor(Math.random()*r));return t}var dims=[null];function setup_dims(){for(let e=1;e<=8;e++){let t=[E(10).pow(e),E(10).pow(e),E(1),E(0),E(0),E(0)];dims.push(t)}}function hard_reset(){window[map+1]={player:{points:E(10),currentPage:1,singleDMult:E(2),ptgain:E(0),lastUpdated:Date.now(),sqrt:{unl:!1,points:E(1),galaxies:E(0)}}},setup_dims(),window[map+1].player.dims=dims}function transformToE(e){for(let t in e)"string"!=typeof e[t]||new E(e[t]).isNaN()||(e[t]=new E(e[t])),"object"==typeof e[t]&&transformToE(e[t])}function save(){localStorage.setItem("pts-inc-rew",formatsave.encode(window[map+1].player))}function load(){if(window.map=generateRandomString(),hard_reset(),null!=localStorage.getItem("pts-inc-rew")){let e=formatsave.decode(localStorage.getItem("pts-inc-rew"));transformToE(e),window[map+1].player=Object.assign(window[map+1].player,e),console.clear()}setInterval(save,10),setInterval(loop,1e3/30),setInterval(updateDisplay,30)}function hasSqUpg(e){return!!window[map+1].player.square.upgrades[e]}function hasP1_5Upg(e){return!!window[map+1].player.P1_5.upgrades[e]}function export_copy(){return navigator.clipboard.writeText(formatsave.encode(window[map+1].player))}function export_file(){let e=formatsave.encode(window[map+1].player),t=new Blob([e],{type:"text/plain"});window.URL=window.URL||window.webkitURL;let r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download="Points Incremental Save - "+getCurrentBeijingTime()+".txt",r.click()}function getCurrentBeijingTime(){const e=new Date,t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),a=String(e.getUTCDate()).padStart(2,"0"),o=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),d=e.getUTCMilliseconds();let p=(o+8)%24;return p<0&&(e.setUTCDate(e.getUTCDate()+1),p+=24),`${t}-${r}-${a} ${p.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}.${d.toString().padStart(3,"0")}`}function import_save(){save=prompt("请输入您的存档"),importing_player=formatsave.decode(save),transformToE(importing_player),Object.assign(window[map+1].player,importing_player),console.clear()}function formated_hard_reset(){if(prompt_text="您确定要硬重置吗？输入1进行第一次确认，此操作无法取消!","1"===prompt(prompt_text)){if(prompt_text="您确定要硬重置吗？输入2进行第二次确认，此操作无法取消!","2"===prompt(prompt_text)){prompt_text="您确定要硬重置吗？输入3进行最后一次确认，此操作无法取消!","3"===prompt(prompt_text)&&hard_reset()}}}function import_file(){let e=document.createElement("input");e.setAttribute("type","file"),e.click(),e.onchange=(()=>{let t=new FileReader;t.onload=(()=>{let e=t.result;importing_player=formatsave.decode(e),transformToE(importing_player),Object.assign(window[map+1].player,importing_player),console.clear()}),t.readAsText(e.files[0])})}var formatsave={encoder:new TextEncoder,decoder:new TextDecoder,startString:"PointsIncrementalRewrittenSaveFormat",endString:"EndOfSaveFile",steps:[{encode:JSON.stringify,decode:JSON.parse},{encode:e=>formatsave.encoder.encode(e),decode:e=>formatsave.decoder.decode(e)},{encode:e=>pako.deflate(e),decode:e=>pako.inflate(e)},{encode:e=>Array.from(e).map(e=>String.fromCharCode(e)).join(""),decode:e=>Uint8Array.from(Array.from(e).map(e=>e.charCodeAt(0)))},{encode:e=>btoa(e),decode:e=>atob(e)},{encode:e=>e.replace(/=+$/g,"").replace(/0/g,"0a").replace(/\+/g,"0b").replace(/\//g,"0c"),decode:e=>e.replace(/0b/g,"+").replace(/0c/g,"/").replace(/0a/g,"0")},{encode:e=>formatsave.startString+e+formatsave.endString,decode:e=>e.slice(formatsave.startString.length,-formatsave.endString.length)}],encode(e){return this.steps.reduce((e,t)=>t.encode(e),e)},decode(e){return this.steps.reduceRight((e,t)=>t.decode(e),e)}};